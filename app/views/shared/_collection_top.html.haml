%a{ name: 'top' }
.container-fluid#header-general
  = render partial: 'shared/breadcrumbs'
  .top-space
  - aus = @collection.authors_string
  - eds = @collection.editors_string if aus.blank?
  - if @collection.parent_collections.count > 0
    = t(:parent_collections)
    %ol
    - @collection.parent_collections.each do |pc|
      %li{ style: 'list-style-type: decimal; font-size:120%;' }= link_to "🢁 🢁 🢁 #{pc.title}", collection_path(pc)

  .work-page-top
    .work-page-top-info-card
      .work-and-author-names-mobile
        .headline-1-v02
          #{textify_collection_type(@collection.collection_type)}: #{@collection.title}
        .headline-3-v02
          - if aus.present?
            #{t(:by)}:
            %span= aus
          - elsif eds.present?
            #{t(:edited_by)}:
            %span= eds
      .row
        .col-12
          .work-and-author-names-desktop
            .headline-1-v02
              #{textify_collection_type(@collection.collection_type)}: #{@collection.title}
            .headline-3-v02
              - if aus.present?
                #{t(:by)}:
                %span= aus
              - elsif eds.present?
                #{t(:edited_by)}:
                %span= eds
          .field-v02.work-chapters-dropdown-field-desktop#collitem_dropdown{style: 'background-color: unset;'}
            = select_tag 'collitem', options_for_select(@htmls.map{ |title, html, is_curated, genre, i| [title, i] }, 0), class: 'dropdown-v02', id: 'chapter', style: 'width: 100%;'

          .work-page-top-icons-desktop
            %button.btn-small-outline-v02.btn-text-v02.reading-mode-btn-v02{href: "#"}
              %span.by-icon-v02= '/'
              = t(:reading_mode)
            .top-left-icons-group
              .icons-group-v02
                .by-icon-v02.pointer.linkcolor.bookmark-status.notyet
                .by-icon-v02.pointer.linkcolor.printbutton= 9
                .by-icon-v02.pointer.linkcolor.download{ data: { 'downloadable-id' => @collection.id, toggle: :modal, target: '#downloadDlg' } }= 3
          .chapters-and-icons-mobile
            .work-page-top-icons-mobile
              .top-left-icons-group
                .icons-group-v02
                  .by-icon-v02.pointer.linkcolor.bookmark-status.notyet
                  .by-icon-v02.pointer.linkcolor.printbutton= 9
                  .by-icon-v02.pointer.linkcolor.download{ data: { 'downloadable-id' => @collection.id, toggle: :modal, target: '#downloadDlg' } }= 3
:javascript
  $(document).ready(function() {
    $('.by-icon-v02.download').click(function(e) {
      e.preventDefault();
      e.stopImmediatePropagation();
      $('#downloadDlg').modal('show');
      $('#downloadable_id').val($(this).attr('data-downloadable-id'));
    });
    $('.printbutton').click(function() {
      window.open("#{@print_url}",'_blank');
    });
    $('#collitem_dropdown').click(function(){
      if($('#collitem_dropdown_content').css('display') == 'block')
        $('#collitem_dropdown_content').css('display', 'none');
      else
        $('#collitem_dropdown_content').css('display', 'block');
    });
    $('.jumpch').click(function(e) {
      e.preventDefault();
      anchor = $(this).attr('data-target');
      $('html, body').animate({
        scrollTop: $('a[name='+anchor+']').offset().top - $('header').height() - 45
      }, 800);
      $('#chapterDlg').modal('hide');
      $('header').addClass("scrolled");
      $('html, body').animate({ // re-adjust, after the header height changed
        scrollTop: $('a[name='+anchor+']').offset().top - $('header').height() - 45
      }, 0);
      $('#actualtext').focus();
    });

  });