.top-element
  %div{ style: 'margin-top:10px' }
    %h1= t(:lexicon_migration) + ': ' + t('.title')

    = form_tag lexicon_files_path, method: :get, id: :filter do
      = label_tag :entrytype, LexFile.human_attribute_name(:entrytype)
      = select_tag :entrytype,
                   options_for_select(LexFile.entrytypes.map { |k, _v| [LexFile.human_enum_name(:entrytype, k), k] },
                                      @entrytype),
                   include_blank: true

    %table.table
      %tr
        %th= LexFile.human_attribute_name(:fname)
        %th= t(:title)
        %th= t(:status)
        %th= t(:entrytype)
        %th= t(:actions)
      - @lex_files.each do |lf|
        %tr
          %td= lf.fname.sub('.php', '').sub('/', '')
          %td= lf.title
          %td= t(lf.status)
          %td= LexFile.human_enum_name(:entrytype, lf.entrytype)
          %td
            - if lf.lex_entry.present?
              = link_to t(:show), lexicon_item_path(lf.lex_entry.lex_item)
            - elsif lf.entrytype_person?
              = link_to t('lexicon.files.migrate_person.title'),
                        migrate_person_lexicon_file_path(lf),
                        method: :post
            - elsif lf.entrytype_text?
              = link_to t('lexicon.files.migrate_publication.title'),
                        migrate_publication_lexicon_file_path(lf),
                        method: :post
  = paginate @lex_files
:javascript
  $(function() {
    const submitFilters = (e) => { $('#filter').submit(); };
    $('#entrytype').change(submitFilters);
  });
