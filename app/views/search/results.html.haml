%br
#content.container-fluid.search_results
  - if @total == -1
    %h1= t(:error)
    %p= @errmsg
  - else
    %h1= "#{t(:search_results)}: #{@search.query}"
    %h4= "#{t(:search_total)}: #{@total} #{t(:items)}"
    %p
    %ol
      - @results.each do |result|
        %li
          - attrs = result.attributes
          - if result.class == ManifestationsIndex
            %b= t(:work)
            %br
            %b= link_to attrs['title'], manifestation_path(attrs['id'])
            = " / #{attrs['author_string']}"
            = " (#{textify_genre(attrs['genre'])})"
            - unless result.tags.empty?
              %br
              %div{style: 'line-height: 2.2;'}
                %b= t(:tags)+':'
                - result.tags.each do |tag|
                  %button.tag
                    = tag
            - unless result._data.nil? or result._data['highlight'].nil?
              %br
              != result._data['highlight']['fulltext'].join("<br />").gsub('<em>','<b>').gsub('</em>','</b>')
          - elsif result.class == PeopleIndex
            %b= t(:author)
            %br
            %b= link_to attrs['name'], person_path(attrs['id'])
            - unless result.tags.empty?
              %br
              %b= t(:tags)+':'
              - result.tags.each do |tag|
                %button.tag
                  = tag
            %br
            %p= attrs['wikipedia_snippet']
          - elsif result.class == DictIndex
            %b= t(:dictionary_definition)
            %br
            %b= link_to attrs['defhead'], dict_entry_path(id: attrs['manifestation_id'], entry: attrs['id'])
            %br
            - unless result._data.nil? or result._data['highlight'].nil?
              %br
              != result._data['highlight']['deftext'].join("<br />").gsub('<em>','<b>').gsub('</em>','</b>')

    != paginate @results