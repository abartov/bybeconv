- unless pubs.nil?
  - pubs.each do |pub|
    .bib-flex-row
      %div= pub.title
      %div= pub.author_line
      %div= pub.publisher_line
      %div= pub.pub_year
      %div= pub.language
      %div= pub.notes.nil? ? '' : pub.notes.sub("\n", "<br />").html_safe
      /%td= pub.holdings.map{|h| linkify_record(pub.context, h.source_id)}.join(';').html_safe
      - sid = (pub.source_id.class == Array ? pub.source_id[0] : pub.holdings[0].source_id)
      %div= linkify_record(pub.context, sid).html_safe
      %div= pub.holdings[0].location
      %div= pub.scanned ? link_to(t(:yes), pub.holdings[0].scan_url) : t(:no)
      %div
        %button.nuke{onclick: 'this.parentElement.parentElement.remove()'}= t(:remove)
        %br
        %button.moveit{onclick: 'moveit(this)'}= t(:add_publication)
        %br
        %button.addholding{onclick: 'addholding(this)'}= t(:add_holding)

:javascript
  $(document).ready(function() {
    $('#total_pubs').text("#{t(:total)+': '+@total_pubs}");
  });
