require 'omnidocx'
# ids = [255, 140, 44, 456, 421, 328, 19, 200, 198, 269, 270, 470, 497, 319, 419, 136, 187, 294, 83, 435, 292, 358, 354, 413, 204, 221, 133, 291, 412, 7, 353, 267, 2, 157, 449, 444, 305, 219, 299, 29, 89, 427, 76, 334, 88, 30, 378, 27, 266, 338]
# ids = [51, 268, 340, 272, 356, 178, 391, 494, 4, 238, 102, 94, 87, 389, 458, 98, 67, 442, 495, 385, 297, 13, 117, 396, 103, 86, 489, 499, 376, 441,

# ids = [53, 162, 148, 113, 110, 380, 408, 203, 14, 414, 49, 415, 194, 71, 210, 10, 130, 501, 290, 407, 403, 205, 138]
#       249, 361, 367, 497, 170, 250, 123, 296, 479, 20, 83, 437, 345, 358, 313, 477, 478, 137, 273, 155, 267, 166, 464, 444, 452, 50, 305, 230, 42, 261, 188, 29, 394, 135, 77, 427, 359, 333, 334, 17, 30, 252, 462, 378, 428, 467, 338]

# #ids = [51, 268, 340, 272, 356, 178, 391, 494, 4, 238, 102, 94, 87, 389, 458, 98, 67]
## ids = [442, 495, 297, 13, 117, 396, 103, 86, 489, 499, 376, 441]
# 385]
## ids = [53, 162, 148, 113, 110, 380, 408, 203, 14, 414, 49, 415, 194, 71, 210]
# #ids = [10, 130]
## ids = [501, 290, 407, 403, 205, 138, 249, 361]
# ids = [367, 497, 170, 250, 123, 296, 479, 20, 83, 437, 345]
# ids = [ 358]
# #ids = [313, 477, 478, 137, 273, 155, 267, 166]
#ids = [464, 444, 452, 50, 305, 230, 42, 261, 188, 29, 394, 135, 77, 427, 359, 333, 334, 17, 30, 252, 462, 378, 428, 467,       338]

ids = [265,257,468,442,315,263,65,354,10,501,220,199,347,14,212,250,192,127,357,461,98,358,27,290,328,376,19,283,491,485,338,314,480,458,112,198,188,253,458,218,166,17,391,419,492] # plus 470 which is unprocessable
puts 'Making DOCX files for given ids'
filenames = ids.map { |id| "output/#{id}.docx" }
Omnidocx::Docx.merge_documents(filenames, 'output/ad_hoc.docx', true)
print 'verifying... '
File.open('ids_to_verify.txt', 'w') { |f| f.puts ids.join(' ') }
verification = `ruby contest_2024_verify.rb output/ad_hoc.docx`
print verification
puts 'done'
